"""
United States standard atmosphere 1976 tables, data
obtained from http://www.digitaldutch.com/atmoscalc/index.htm
"""
from collections import namedtuple

import numpy as np

import openmdao.api as om


USatm1976Data = namedtuple('USatm1976Data', ['alt', 'temp', 'pres', 'rho', 'a', 'viscosity'])
USatm1976Data.__doc__ = \
    """
    A namedtuple to hold data for the 1976 standard atmosphere model.

    Parameters
    ----------
    alt : float
        Altitude in feet.
    temp : float
        Temperature in degR.
    pres : float
        Pressure in psi.
    rho : float
        Density in slug/ft**3.
    a : float
        Speed of sound in ft/s.
    viscosity : float
        Dynamic viscosity in lbf*s/ft**2.
    """

# units='ft'
USatm1976Data.alt = np.array([-1000, 0, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000,
                              11000, 12000, 13000, 14000, 15000, 16000, 17000, 18000, 19000, 20000,
                              21000, 22000, 23000, 24000, 25000, 26000, 27000, 28000, 29000, 30000,
                              31000, 32000, 33000, 34000, 35000, 36000, 37000, 38000, 39000, 40000,
                              41000, 42000, 43000, 44000, 45000, 46000, 47000, 48000, 49000, 50000,
                              51000, 52000, 53000, 54000, 55000, 56000, 57000, 58000, 59000, 60000,
                              61000, 62000, 63000, 64000, 65000, 66000, 67000, 68000, 69000, 70000,
                              71000, 72000, 73000, 74000, 75000, 76000, 77000, 78000, 79000, 80000,
                              81000, 82000, 83000, 84000, 85000, 86000, 87000, 88000, 89000, 90000,
                              91000, 92000, 93000, 94000, 95000, 96000, 97000, 98000, 99000, 100000,
                              105000, 110000, 115000, 120000, 125000, 130000, 135000, 140000,
                              145000, 150000], dtype=float)

# units='degR'
USatm1976Data.T = np.array([522.236, 518.67, 515.104, 511.538, 507.972, 504.405, 500.839, 497.273,
                            493.707, 490.141, 486.575, 483.008, 479.442, 475.876, 472.31, 468.744,
                            465.178, 461.611, 458.045, 454.479, 450.913, 447.347, 443.781, 440.214,
                            436.648, 433.082, 429.516, 425.95, 422.384, 418.818, 415.251, 411.685,
                            408.119, 404.553, 400.987, 397.421, 393.854, 390.288, 389.97, 389.97,
                            389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97,
                            389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97,
                            389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97, 389.97,
                            390.18, 390.729, 391.278, 391.826, 392.375, 392.923, 393.472, 394.021,
                            394.569, 395.118, 395.667, 396.215, 396.764, 397.313, 397.861, 398.41,
                            398.958, 399.507, 400.056, 400.604, 401.153, 401.702, 402.25, 402.799,
                            403.348, 403.896, 404.445, 404.994, 405.542, 406.091, 406.639, 407.188,
                            407.737, 408.285, 408.834, 411.59, 419.271, 426.952, 434.633, 442.314,
                            449.995, 457.676, 465.357, 473.038, 480.719])

# units='psi'
USatm1976Data.P = np.array([15.2348, 14.6959, 14.1726, 13.6644, 13.1711, 12.6923, 12.2277, 11.777,
                            11.3398, 10.9159, 10.5049, 10.1065, 9.7204, 9.34636, 8.98405, 8.63321,
                            8.29354, 7.96478, 7.64665, 7.33889, 7.04123, 6.75343, 6.47523, 6.20638,
                            5.94664, 5.69578, 5.45355, 5.21974, 4.9941, 4.77644, 4.56651, 4.36413,
                            4.16906, 3.98112, 3.8001, 3.6258, 3.45803, 3.29661, 3.14191, 2.99447,
                            2.85395, 2.72003, 2.59239, 2.47073, 2.35479, 2.24429, 2.13897, 2.0386,
                            1.94293, 1.85176, 1.76486, 1.68204, 1.60311, 1.52788, 1.45618, 1.38785,
                            1.32272, 1.26065, 1.20149, 1.14511, 1.09137, 1.04016, 0.991347,
                            0.944827, 0.900489, 0.858232, 0.817958, 0.779578, 0.743039, 0.708261,
                            0.675156, 0.643641, 0.613638, 0.585073, 0.557875, 0.531976, 0.507313,
                            0.483825, 0.461455, 0.440148, 0.419853, 0.400519, 0.382101, 0.364553,
                            0.347833, 0.331902, 0.31672, 0.302253, 0.288464, 0.275323, 0.262796,
                            0.250856, 0.239473, 0.228621, 0.218275, 0.20841, 0.199003, 0.190032,
                            0.181478, 0.173319, 0.165537, 0.158114, 0.12582, 0.10041, 0.08046,
                            0.064729, 0.0522725, 0.0423688, 0.0344637, 0.0281301, 0.0230369,
                            0.0189267])

# units='slug/ft**3'
USatm1976Data.rho = np.array([0.00244752, 0.00237717, 0.00230839, 0.00224114, 0.00217539,
                              0.00211114, 0.00204834, 0.00198698, 0.00192704, 0.0018685, 0.00181132,
                              0.00175549, 0.00170099, 0.00164779, 0.00159588, 0.00154522, 0.00149581,
                              0.00144761, 0.00140061, 0.00135479, 0.00131012, 0.00126659, 0.00122417,
                              0.00118285, 0.0011426, 0.00110341, 0.00106526, 0.00102812, 0.000991984,
                              0.000956827, 0.000922631, 0.000889378, 0.00085705, 0.000825628,
                              0.000795096, 0.000765434, 0.000736627, 0.000708657, 0.000675954,
                              0.000644234, 0.000614002, 0.000585189, 0.000557728, 0.000531556,
                              0.000506612, 0.000482838, 0.00046018, 0.000438586, 0.000418004,
                              0.000398389, 0.000379694, 0.000361876, 0.000344894, 0.000328709,
                              0.000313284, 0.000298583, 0.000284571, 0.000271217, 0.00025849,
                              0.00024636, 0.000234799, 0.000223781, 0.000213279, 0.000203271,
                              0.000193732, 0.000184641, 0.000175976, 0.000167629, 0.000159548,
                              0.000151867, 0.000144566, 0.000137625, 0.000131026, 0.000124753,
                              0.000118788, 0.000113116, 0.000107722, 0.000102592, 9.77131E-05,
                              9.30725E-05, 8.86582E-05, 0.000084459, 8.04641E-05, 7.66632E-05,
                              7.30467E-05, 6.96054E-05, 6.63307E-05, 6.32142E-05, 6.02481E-05,
                              5.74249E-05, 5.47376E-05, 5.21794E-05, 4.97441E-05, 4.74254E-05,
                              4.52178E-05, 4.31158E-05, 0.000041114, 3.92078E-05, 3.73923E-05,
                              3.56632E-05, 3.40162E-05, 3.24473E-05, 2.56472E-05, 2.00926E-05,
                              1.58108E-05, 1.24948E-05, 9.9151E-06, 7.89937E-06, 6.3177E-06,
                              5.07154E-06, 4.08586E-06, 3.30323E-06])

# units='ft/s'
USatm1976Data.a = np.array([1120.28, 1116.45, 1112.61, 1108.75, 1104.88, 1100.99, 1097.09, 1093.18,
                            1089.25, 1085.31, 1081.36, 1077.39, 1073.4, 1069.4, 1065.39, 1061.36,
                            1057.31, 1053.25, 1049.18, 1045.08, 1040.97, 1036.85, 1032.71, 1028.55,
                            1024.38, 1020.19, 1015.98, 1011.75, 1007.51, 1003.24, 998.963, 994.664,
                            990.347, 986.01, 981.655, 977.28, 972.885, 968.471, 968.076, 968.076,
                            968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076,
                            968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076,
                            968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076, 968.076,
                            968.076, 968.076, 968.076, 968.337, 969.017, 969.698, 970.377, 971.056,
                            971.735, 972.413, 973.091, 973.768, 974.445, 975.121, 975.797, 976.472,
                            977.147, 977.822, 978.496, 979.169, 979.842, 980.515, 981.187, 981.858,
                            982.53, 983.2, 983.871, 984.541, 985.21, 985.879, 986.547, 987.215,
                            987.883, 988.55, 989.217, 989.883, 990.549, 991.214, 994.549, 1003.79,
                            1012.94, 1022.01, 1031, 1039.91, 1048.75, 1057.52,
                            1066.21, 1074.83])

# units='lbf*s/ft**2'
USatm1976Data.viscosity = np.array([3.81E-07, 3.78E-07, 3.76E-07, 3.74E-07, 3.72E-07, 3.70E-07,
                                    3.68E-07, 3.66E-07, 3.64E-07, 3.62E-07, 3.60E-07, 3.57E-07,
                                    3.55E-07, 3.53E-07, 3.51E-07, 3.49E-07, 3.47E-07, 3.45E-07,
                                    3.42E-07, 3.40E-07, 3.38E-07, 3.36E-07, 3.34E-07, 3.31E-07,
                                    3.29E-07, 3.27E-07, 3.25E-07, 3.22E-07, 3.20E-07, 3.18E-07,
                                    3.16E-07, 3.13E-07, 3.11E-07, 3.09E-07, 3.06E-07, 3.04E-07,
                                    3.02E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07,
                                    2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07,
                                    2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07,
                                    2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07,
                                    2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07, 2.99E-07,
                                    2.99E-07, 2.99E-07, 3.00E-07, 3.00E-07, 3.00E-07, 3.01E-07,
                                    3.01E-07, 3.01E-07, 3.02E-07, 3.02E-07, 3.03E-07, 3.03E-07,
                                    3.03E-07, 3.04E-07, 3.04E-07, 3.04E-07, 3.05E-07, 3.05E-07,
                                    3.05E-07, 3.06E-07, 3.06E-07, 3.06E-07, 3.07E-07, 3.07E-07,
                                    3.08E-07, 3.08E-07, 3.08E-07, 3.09E-07, 3.09E-07, 3.09E-07,
                                    3.10E-07, 3.10E-07, 3.10E-07, 3.11E-07, 3.11E-07, 3.11E-07,
                                    3.13E-07, 3.18E-07, 3.23E-07, 3.28E-07, 3.33E-07, 3.37E-07,
                                    3.42E-07, 3.47E-07, 3.51E-07, 3.56E-07])

# units='degR'
USatm1976Data.akima_T = np.array([[ 5.2223599999999999e+02, -3.5660000000000878e-03,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 5.2223599999999999e+02, -3.5660000000000878e-03,
                                    5.6812193838240435e-20,  0.0000000000000000e+00],
                                  [ 5.1866999999999996e+02, -3.5659999999999741e-03,
                                    2.2638141361497333e-19, -1.7000290064572711e-22],
                                  [ 5.1510400000000004e+02, -3.5660000000000310e-03,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 5.1153800000000001e+02, -3.5660000000000310e-03,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 5.0797199999999998e+02, -3.5660000000000310e-03,
                                    -2.9999999999852195e-09,  2.0000000000098066e-12],
                                  [ 5.0440499999999997e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 5.0083900000000000e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 4.9727300000000002e+02, -3.5659999999999741e-03,
                                    -1.4181364416110399e-19,  8.5001450322863557e-23],
                                  [ 4.9370699999999999e+02, -3.5660000000000028e-03,
                                    5.6812193838240435e-20, -2.8622937353617319e-23],
                                  [ 4.9014100000000002e+02, -3.5659999999999741e-03,
                                    -5.7245874707234637e-20,  0.0000000000000000e+00],
                                  [ 4.8657499999999999e+02, -3.5660000000000873e-03,
                                    -2.9999999998156504e-09,  1.9999999998961819e-12],
                                  [ 4.8300799999999998e+02, -3.5660000000000310e-03,
                                    1.7000290064572710e-19, -1.1362438767648088e-22],
                                  [ 4.7944200000000001e+02, -3.5660000000000310e-03,
                                    -5.6812193838240435e-20,  5.7245874707234639e-23],
                                  [ 4.7587599999999998e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 4.7231000000000000e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 4.6874400000000003e+02, -3.5659999999999741e-03,
                                    -5.7245874707234637e-20,  0.0000000000000000e+00],
                                  [ 4.6517800000000000e+02, -3.5660000000000873e-03,
                                    -2.9999999998156504e-09,  1.9999999998961819e-12],
                                  [ 4.6161099999999999e+02, -3.5660000000000310e-03,
                                    1.7000290064572710e-19, -1.1362438767648088e-22],
                                  [ 4.5804500000000002e+02, -3.5660000000000310e-03,
                                    -2.8189256484623116e-20,  2.7755575615628912e-23],
                                  [ 4.5447899999999998e+02, -3.5660000000000028e-03,
                                    8.5435131191857753e-20, -5.7245874707234639e-23],
                                  [ 4.5091300000000001e+02, -3.5660000000000028e-03,
                                    -5.6378512969246232e-20,  2.7755575615628912e-23],
                                  [ 4.4734699999999998e+02, -3.5660000000000310e-03,
                                    1.7000290064572710e-19, -1.1362438767648088e-22],
                                  [ 4.4378100000000001e+02, -3.5660000000000310e-03,
                                    -2.9999999999284071e-09,  1.9999999999525607e-12],
                                  [ 4.4021400000000000e+02, -3.5660000000000310e-03,
                                    1.7000290064572710e-19, -1.1362438767648088e-22],
                                  [ 4.3664800000000002e+02, -3.5660000000000310e-03,
                                    -2.8189256484623116e-20,  2.7755575615628912e-23],
                                  [ 4.3308199999999999e+02, -3.5660000000000028e-03,
                                    8.5435131191857753e-20, -5.7245874707234639e-23],
                                  [ 4.2951600000000002e+02, -3.5660000000000028e-03,
                                    -8.4567769453869349e-20,  5.6378512969246237e-23],
                                  [ 4.2594999999999999e+02, -3.5660000000000028e-03,
                                    5.6812193838240435e-20, -2.8622937353617319e-23],
                                  [ 4.2238400000000001e+02, -3.5659999999999741e-03,
                                    -5.7245874707234637e-20,  0.0000000000000000e+00],
                                  [ 4.1881799999999998e+02, -3.5660000000000873e-03,
                                    -2.9999999998724624e-09,  1.9999999999525607e-12],
                                  [ 4.1525099999999998e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 4.1168500000000000e+02, -3.5659999999999741e-03,
                                    -4.3368086899420178e-22,  0.0000000000000000e+00],
                                  [ 4.0811900000000003e+02, -3.5659999999999741e-03,
                                    -1.4181364416110399e-19,  8.5001450322863557e-23],
                                  [ 4.0455300000000000e+02, -3.5660000000000028e-03,
                                    5.6812193838240435e-20, -2.8622937353617319e-23],
                                  [ 4.0098700000000002e+02, -3.5659999999999741e-03,
                                    -5.7245874707234637e-20,  0.0000000000000000e+00],
                                  [ 3.9742099999999999e+02, -3.5660000000000873e-03,
                                    -2.0003077868505255e-09,  1.0003077869314912e-12],
                                  [ 3.9385399999999998e+02, -3.5669996922129961e-03,
                                    -8.1824337561115646e-09,  9.1821259691335021e-12],
                                  [ 3.9028800000000001e+02, -3.5558181818178191e-03,
                                    6.1576363636356872e-06, -2.9198181818178519e-09],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 3.8997000000000003e+02,  0.0000000000000000e+00,
                                    8.1000000000052169e-08,  1.2899999999992741e-10],
                                  [ 3.9018000000000001e+02,  5.4899999999988649e-04,
                                    1.2674323396355547e-19, -3.5128150388530345e-23],
                                  [ 3.9072899999999998e+02,  5.4900000000003481e-04,
                                    5.7137454489986086e-20, -5.7029034272737532e-23],
                                  [ 3.9127800000000002e+02,  5.4899999999997822e-04,
                                    -2.4999999999552289e-09,  1.4999999999789488e-12],
                                  [ 3.9182600000000002e+02,  5.4850000000000428e-04,
                                    1.4999999999359059e-09, -9.9999999996218575e-13],
                                  [ 3.9237500000000000e+02,  5.4849999999999008e-04,
                                    -1.9999999998960736e-09,  1.4999999999078252e-12],
                                  [ 3.9292300000000000e+02,  5.4899999999992140e-04,
                                    8.5109870540112101e-20, -2.8406096919120219e-23],
                                  [ 3.9347199999999998e+02,  5.4900000000000662e-04,
                                    1.1351596745923231e-19, -8.5218290757360651e-23],
                                  [ 3.9402100000000002e+02,  5.4899999999997822e-04,
                                    -2.9999999999291660e-09,  1.9999999999527776e-12],
                                  [ 3.9456900000000002e+02,  5.4899999999997822e-04,
                                    -1.0842021724855045e-22,  0.0000000000000000e+00],
                                  [ 3.9511799999999999e+02,  5.4899999999997822e-04,
                                    -1.0842021724855045e-22,  0.0000000000000000e+00],
                                  [ 3.9566699999999997e+02,  5.4899999999997822e-04,
                                    -2.9999999999291660e-09,  1.9999999999527776e-12],
                                  [ 3.9621499999999997e+02,  5.4899999999997822e-04,
                                    1.4192206437835252e-19, -8.5218290757360651e-23],
                                  [ 3.9676400000000001e+02,  5.4900000000000662e-04,
                                    -1.0842021724855045e-22, -2.8406096919120219e-23],
                                  [ 3.9731299999999999e+02,  5.4899999999992140e-04,
                                    -2.4999999998414961e-09,  1.4999999999219198e-12],
                                  [ 3.9786099999999999e+02,  5.4850000000000417e-04,
                                    1.5000000000924647e-09, -1.0000000000617154e-12],
                                  [ 3.9841000000000003e+02,  5.4850000000000417e-04,
                                    -1.9999999999810751e-09,  1.4999999999787319e-12],
                                  [ 3.9895800000000003e+02,  5.4899999999997822e-04,
                                  -1.0842021724855045e-22,  0.0000000000000000e+00],
                                  [ 3.9950700000000001e+02,  5.4899999999997822e-04,
                                    -1.0842021724855045e-22,  0.0000000000000000e+00],
                                  [ 4.0005599999999998e+02,  5.4899999999997822e-04,
                                    -2.9999999999291660e-09,  1.9999999999527776e-12],
                                  [ 4.0060399999999998e+02,  5.4899999999997822e-04,
                                    1.4192206437835252e-19, -8.5218290757360651e-23],
                                  [ 4.0115300000000002e+02,  5.4900000000000662e-04,
                                    -1.0842021724855045e-22, -2.8406096919120219e-23],
                                  [ 4.0170200000000000e+02,  5.4899999999992140e-04,
                                    -2.9999999997587296e-09,  1.9999999998391533e-12],
                                  [ 4.0225000000000000e+02,  5.4899999999992140e-04,
                                    8.5109870540112101e-20, -2.8406096919120219e-23],
                                  [ 4.0279899999999998e+02,  5.4900000000000662e-04,
                                    1.1351596745923231e-19, -8.5218290757360651e-23],
                                  [ 4.0334800000000001e+02,  5.4899999999997822e-04,
                                    -2.9999999998723540e-09,  1.9999999998959654e-12],
                                  [ 4.0389600000000002e+02,  5.4899999999992140e-04,
                                    8.5218290757360652e-20, -2.8406096919120219e-23],
                                  [ 4.0444499999999999e+02,  5.4900000000000651e-04,
                                    1.1373280789372941e-19, -8.5218290757360651e-23],
                                  [ 4.0499400000000003e+02,  5.4899999999997822e-04,
                                    -2.5000000001255574e-09,  1.5000000000923563e-12],
                                  [ 4.0554199999999997e+02,  5.4850000000000417e-04,
                                    1.5000000001066678e-09, -1.0000000000758102e-12],
                                  [ 4.0609100000000001e+02,  5.4849999999998997e-04,
                                    -1.9999999998958568e-09,  1.4999999999078252e-12],
                                  [ 4.0663900000000001e+02,  5.4899999999992140e-04,
                                    8.5109870540112101e-20, -2.8406096919120219e-23],
                                  [ 4.0718799999999999e+02,  5.4900000000000662e-04,
                                    1.1351596745923231e-19, -8.5218290757360651e-23],
                                  [ 4.0773700000000002e+02,  5.4899999999997822e-04,
                                    -2.3124999999509217e-09,  1.3124999999744244e-12],
                                  [ 4.0828500000000003e+02,  5.4831249999999997e-04,
                                    1.3727687626338734e-09, -6.8526876265584575e-13],
                                  [ 4.0883400000000000e+02,  5.4900223123730072e-04,
                                    -1.9612089249391552e-07,  3.9312089249290861e-11],
                                  [ 4.1158999999999997e+02,  1.5361999999948626e-03,
                                    2.0605045447652514e-18, -2.0627596852840215e-22],
                                  [ 4.1927100000000002e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.2695200000000000e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.3463299999999998e+02,  1.5361999999999967e-03,
                                    6.8521577301083887e-21, -9.1940344226770777e-25],
                                  [ 4.4231400000000002e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.4999500000000000e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.5767599999999999e+02,  1.5361999999999967e-03,
                                    6.8521577301083887e-21, -9.1940344226770777e-25],
                                  [ 4.6535700000000003e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.7303800000000001e+02,  1.5361999999999967e-03,
                                    8.6736173798840359e-23,  0.0000000000000000e+00],
                                  [ 4.8071899999999999e+02,  1.5361999999999967e-03,
                                    0.0000000000000000e+00,  0.0000000000000000e+00]])

# units='psi'
USatm1976Data.akima_P = np.array([[ 1.5234800000000000e+01, -5.4669999999999957e-04,
                                    0.0000000000000000e+00,  0.0000000000000000e+00],
                                  [ 1.5234800000000000e+01, -5.4669999999999957e-04,
                                    7.6729641693815048e-09,  1.2703583061814301e-13],
                                  [ 1.4695900000000000e+01, -5.3097296416938214e-04,
                                    7.6226496502368067e-09,  5.0314519144589384e-14],
                                  [ 1.4172599999999999e+01, -5.1557672131147465e-04,
                                    7.1524291094395664e-09,  2.2429220203627926e-13],
                                  [ 1.3664400000000001e+01, -5.0059898648648646e-04,
                                    7.1735743475404142e-09,  1.2541213894462501e-13],
                                  [ 1.3171099999999999e+01, -4.8587560137457176e-04,
                                    6.9012027491428541e-09,  1.7439862542935251e-13],
                                  [ 1.2692299999999999e+01, -4.7154999999999832e-04,
                                    6.7743682310470272e-09,  1.7563176895230189e-13],
                                  [ 1.2227700000000000e+01, -4.5747436823104752e-04,
                                    6.6498394032682585e-09,  1.2452882777800983e-13],
                                  [ 1.1776999999999999e+01, -4.4380110294117687e-04,
                                    6.4010695187189694e-09,  2.0003342245892425e-13],
                                  [ 1.1339800000000000e+01, -4.3039886363636199e-04,
                                    6.3734029484018065e-09,  1.2546068796034406e-13],
                                  [ 1.0915900000000001e+01, -4.1727567567567713e-04,
                                    6.1013513513501422e-09,  1.7432432432567135e-13],
                                  [ 1.0504899999999999e+01, -4.0454999999999994e-04,
                                    6.0153284671564713e-09,  1.3467153284478940e-13],
                                  [ 1.0106500000000000e+01, -3.9211532846715290e-04,
                                    5.8576232264382384e-09,  1.5770524071389604e-13],
                                  [ 9.7203999999999997e+00, -3.7992696629213473e-04,
                                    5.7618713858021257e-09,  1.2509490633367661e-13],
                                  [ 9.3463600000000007e+00, -3.6802793880152978e-04,
                                    5.5606330615731011e-09,  1.5730573995590033e-13],
                                  [ 8.9840499999999999e+00, -3.5643475545851598e-04,
                                    5.4647611404459188e-09,  1.2999431807023382e-13],
                                  [ 8.6332100000000001e+00, -3.4511525022341345e-04,
                                    5.3003765936159040e-09,  1.4487362979750954e-13],
                                  [ 8.2935400000000001e+00, -3.3407987614678889e-04,
                                    5.1898791732772645e-09,  1.2999697351174721e-13],
                                  [ 7.9647800000000002e+00, -3.2331012687969923e-04,
                                    5.0426898423698292e-09,  1.3743703732938329e-13],
                                  [ 7.6466500000000002e+00, -3.1281243608297142e-04,
                                    4.9275612415734543e-09,  1.2487484139789284e-13],
                                  [ 7.3388900000000001e+00, -3.0258268907563067e-04,
                                    4.7902512477068436e-09,  1.3243782792334882e-13],
                                  [ 7.0412299999999997e+00, -2.9260487309644694e-04,
                                    4.6823125645756153e-09,  1.2256053187153888e-13],
                                  [ 6.7534299999999998e+00, -2.8287256637168126e-04,
                                    4.5476982163713124e-09,  1.2486815530990317e-13],
                                  [ 6.4752299999999998e+00, -2.7340256547300881e-04,
                                    4.4326954002147489e-09,  1.1987007279444171e-13],
                                  [ 6.2063800000000002e+00, -2.6417756445419588e-04,
                                    4.3149936209065273e-09,  1.2257083328946068e-13],
                                  [ 5.9466400000000004e+00, -2.5517986471251428e-04,
                                    4.2099953209818022e-09,  1.0986939153216288e-13],
                                  [ 5.6957800000000001e+00, -2.4643026589595419e-04,
                                    4.0752579823842926e-09,  1.2500791356971848e-13],
                                  [ 5.4535499999999999e+00, -2.3790472619047645e-04,
                                    3.9948548199765520e-09,  9.9871370499830550e-14],
                                  [ 5.2197399999999998e+00, -2.2961540243902383e-04,
                                    3.8503897837097159e-09,  1.2501265531474679e-13],
                                  [ 4.9941000000000004e+00, -2.2153958490566024e-04,
                                    3.7871543573595995e-09,  9.2430548300230432e-14],
                                  [ 4.7764400000000000e+00, -2.1368798454604040e-04,
                                    3.6355502091018463e-09,  1.2243433693861747e-13],
                                  [ 4.5665100000000001e+00, -2.0604958111702086e-04,
                                    3.5795913893559169e-09,  8.9989727665212760e-14],
                                  [ 4.3641300000000003e+00, -1.9862042915531352e-04,
                                    3.4381527589747167e-09,  1.1227639633846261e-13],
                                  [ 4.1690600000000000e+00, -1.9140729444834859e-04,
                                    3.3721629039178886e-09,  9.5131544430870658e-14],
                                  [ 3.9811200000000002e+00, -1.8437757400722009e-04,
                                    3.2577205051462136e-09,  9.9853502073690803e-14],
                                  [ 3.8001000000000000e+00, -1.7756257249070662e-04,
                                    3.1677157541748883e-09,  9.4856736531560939e-14],
                                  [ 3.6257999999999999e+00, -1.7094257077276205e-04,
                                    3.2156698474111702e-09, -4.3099074649010499e-14],
                                  [ 3.4580299999999999e+00, -1.6464052830188693e-04,
                                    3.3057149432296417e-09, -8.5186641342826195e-14],
                                  [ 3.2966099999999998e+00, -1.5828465833945613e-04,
                                    3.5925424853646695e-09, -7.8841459081810399e-15],
                                  [ 3.1419100000000002e+00, -1.5112322580645128e-04,
                                    3.7416897081406203e-09, -5.8463901689406657e-14],
                                  [ 2.9944700000000002e+00, -1.4381523809523812e-04,
                                    3.1304761904764878e-09,  1.6476190476164650e-13],
                                  [ 2.8539500000000002e+00, -1.3706000000000021e-04,
                                    2.9852464228932937e-09,  1.5475357710667982e-13],
                                  [ 2.7200299999999999e+00, -1.3062524642289369e-04,
                                    2.8409595124538592e-09,  1.4428691043984112e-13],
                                  [ 2.5923900000000000e+00, -1.2451046666666645e-04,
                                    2.7056969060128198e-09,  1.4476976065378181e-13],
                                  [ 2.4707300000000001e+00, -1.1866476357267953e-04,
                                    2.5947748517808243e-09,  1.2998872089855477e-13],
                                  [ 2.3547899999999999e+00, -1.1308524770642223e-04,
                                    2.4583491183302831e-09,  1.2689858809190726e-13],
                                  [ 2.2442899999999999e+00, -1.0778785370548596e-04,
                                    2.3404644959923234e-09,  1.2738920949378375e-13],
                                  [ 2.1389700000000000e+00, -1.0272475708501998e-04,
                                    2.2476094081356833e-09,  1.0714767688445141e-13],
                                  [ 2.0386000000000002e+00, -9.7908095238095295e-05,
                                    2.1183309444177265e-09,  1.1976429367744940e-13],
                                  [ 1.9429300000000000e+00, -9.3312140468227548e-05,
                                    2.0447704469445738e-09,  9.7370021282991703e-14],
                                  [ 1.8517600000000001e+00, -8.8930489510489398e-05,
                                    1.9259790209789705e-09,  1.0451048951045663e-13],
                                  [ 1.7648600000000001e+00, -8.4765000000000101e-05,
                                    1.8499999999998553e-09,  9.5000000000113456e-14],
                                  [ 1.6820400000000000e+00, -8.0780000000000023e-05,
                                    1.7602425876013436e-09,  8.9757412398742088e-14],
                                  [ 1.6031100000000000e+00, -7.6990242587601150e-05,
                                    1.6731018654423599e-09,  8.7140722158658272e-14],
                                  [ 1.5278799999999999e+00, -7.3382616690240455e-05,
                                    1.5976107950428041e-09,  8.5005895197778734e-14],
                                  [ 1.4561800000000000e+00, -6.9932377414561511e-05,
                                    1.5276164154373575e-09,  7.4760999124176077e-14],
                                  [ 1.3878500000000000e+00, -6.6652861586314336e-05,
                                    1.4431045146904199e-09,  7.9757071623785863e-14],
                                  [ 1.3227199999999999e+00, -6.3527381342062139e-05,
                                    1.3900024101521207e-09,  6.7378931910180426e-14],
                                  [ 1.2606500000000000e+00, -6.0545239726027377e-05,
                                    1.3128578304328036e-09,  7.2381895594461707e-14],
                                  [ 1.2014899999999999e+00, -5.7702378378378364e-05,
                                    1.2626098641016996e-09,  5.9768514276773701e-14],
                                  [ 1.1451100000000001e+00, -5.4997853107344616e-05,
                                    1.1896788174286914e-09,  6.8174289915805947e-14],
                                  [ 1.0913700000000000e+00, -5.2413972602739816e-05,
                                    1.1505514671425276e-09,  5.3421135597322876e-14],
                                  [ 1.0401600000000000e+00, -4.9952606261662819e-05,
                                    1.0788803547298829e-09,  6.0725906932921096e-14],
                                  [ 9.9134699999999998e-01, -4.7612667831404243e-05,
                                    1.0414568333617269e-09,  5.1210998042514189e-14],
                                  [ 9.4482699999999997e-01, -4.5376121170553267e-05,
                                    9.8602817544028673e-10,  5.2092995112999281e-14],
                                  [ 9.0048899999999998e-01, -4.3247785834333709e-05,
                                    9.4342751772409033e-10,  4.7358316609640688e-14],
                                  [ 8.5823199999999999e-01, -4.1218855849056641e-05,
                                    9.0754590313409508e-10,  3.7309945922497254e-14],
                                  [ 8.1795799999999996e-01, -3.9291834205020925e-05,
                                    8.6967278760689067e-10,  4.2161417414059676e-14],
                                  [ 7.7957799999999999e-01, -3.7426004377564944e-05,
                                    8.5141313760000647e-10,  3.5591239964941009e-14],
                                  [ 7.4303900000000001e-01, -3.5616404382470095e-05,
                                    7.9762255186957249e-10,  4.0781830600551486e-14],
                                  [ 7.0826100000000003e-01, -3.3898813786929309e-05,
                                    7.5244076067165589e-10,  4.1373026257596618e-14],
                                  [ 6.7515599999999998e-01, -3.2269813186813194e-05,
                                    7.1567657177704646e-10,  3.9136615036195963e-14],
                                  [ 6.4364100000000002e-01, -3.0721050198150540e-05,
                                    6.8088816983362216e-10,  3.7162028316910755e-14],
                                  [ 6.1363800000000002e-01, -2.9247787773532553e-05,
                                    6.4736363621361808e-10,  3.5424137318876039e-14],
                                  [ 5.8507299999999995e-01, -2.7846788089148699e-05,
                                    6.1538908648038419e-10,  3.3399002668380096e-14],
                                  [ 5.5787500000000001e-01, -2.6515812908182818e-05,
                                    5.8465087699617998e-10,  3.2162031186627084e-14],
                                  [ 5.3197600000000000e-01, -2.5250025060630566e-05,
                                    5.5710024870381340e-10,  2.9924811926762278e-14],
                                  [ 5.0731300000000001e-01, -2.4046050127442653e-05,
                                    5.2912527722664981e-10,  2.8924850215990004e-14],
                                  [ 4.8382500000000001e-01, -2.2901025022341380e-05,
                                    5.0409980994098969e-10,  2.6925212400395954e-14],
                                  [ 4.6145500000000000e-01, -2.1812049765258230e-05,
                                    4.7859953051642298e-10,  2.6450234741778281e-14],
                                  [ 4.4014799999999998e-01, -2.0775500000000032e-05,
                                    4.5657468879669345e-10,  2.3925311203333556e-14],
                                  [ 4.1985299999999998e-01, -1.9790574688796658e-05,
                                    4.3238695268895500e-10,  2.4187736107738463e-14],
                                  [ 4.0051900000000001e-01, -1.8853237575095536e-05,
                                    4.1352560890670396e-10,  2.1711966188843174e-14],
                                  [ 3.8210100000000002e-01, -1.7961050458715602e-05,
                                    3.9188753587603432e-10,  2.1162922839558594e-14],
                                  [ 3.6455300000000002e-01, -1.7113786618444857e-05,
                                    3.7331071311038670e-10,  2.0475905334464727e-14],
                                  [ 3.4783300000000000e-01, -1.6305737476220707e-05,
                                    3.5654875563281391e-10,  1.8188720587861879e-14],
                                  [ 3.3190199999999997e-01, -1.5538073803191483e-05,
                                    3.3686029033537832e-10,  1.9213512856132259e-14],
                                  [ 3.1672000000000000e-01, -1.4806712683952328e-05,
                                    3.2376139138226473e-10,  1.5951292570055987e-14],
                                  [ 3.0225299999999999e-01, -1.4111336023477629e-05,
                                    3.0462251135156152e-10,  1.7713512126074661e-14],
                                  [ 2.8846400000000000e-01, -1.3448950464396289e-05,
                                    2.9373736603953324e-10,  1.4213098356743684e-14],
                                  [ 2.7532299999999998e-01, -1.2818836437246995e-05,
                                    2.7588636723516129e-10,  1.5950070011824445e-14],
                                  [ 2.6279599999999997e-01, -1.2219213492741204e-05,
                                    2.6597707492798146e-10,  1.3236417813272336e-14],
                                  [ 2.5085600000000002e-01, -1.1647550089445424e-05,
                                    2.5086217324638529e-10,  1.3687916199005490e-14],
                                  [ 2.3947299999999999e-01, -1.1104761994355634e-05,
                                    2.4002398871125483e-10,  1.2738005644374818e-14],
                                  [ 2.2862099999999999e-01, -1.0586499999999993e-05,
                                    2.2852489626554665e-10,  1.1975103734452162e-14],
                                  [ 2.1827500000000000e-01, -1.0093524896265545e-05,
                                    2.1681206079720826e-10,  1.1712835468350251e-14],
                                  [ 2.0841000000000001e-01, -9.6247622682660722e-06,
                                    2.0730967938929948e-10,  1.0452588876774507e-14],
                                  [ 1.9900300000000001e-01, -9.1787851428571480e-06,
                                    1.9678328210417881e-10,  1.1001860752963113e-14],
                                  [ 1.9003200000000001e-01, -8.7522129963899011e-06,
                                    1.8897637061353546e-10,  9.2366257763590933e-15],
                                  [ 1.8147800000000000e-01, -8.3465503778337529e-06,
                                    1.7760075566751965e-10,  9.9496221662373210e-15],
                                  [ 1.7331900000000000e-01, -7.9615000000000101e-06,
                                    2.5808813003279888e-10, -7.8588130032801687e-14],
                                  [ 1.6553699999999999e-01, -7.6810881300328123e-06,
                                    3.1675939176284702e-10, -5.8671261730018531e-14],
                                  [ 1.5811400000000000e-01, -7.2235831316971789e-06,
                                    1.7679054477107915e-10, -4.7667836863288731e-15],
                                  [ 1.2581999999999999e-01, -5.8131864604610512e-06,
                                    1.5706383033411032e-10, -2.1653076483799066e-15],
                                  [ 1.0041000000000000e-01, -4.4049462307484427e-06,
                                    6.0485378784007895e-11,  4.5007734731361679e-15],
                                  [ 8.0460000000000004e-02, -3.4625344324231512e-06,
                                    4.4929971911933554e-11,  3.6673829145392874e-15],
                                  [ 6.4728999999999995e-02, -2.7381809947133705e-06,
                                    3.5342687468326228e-11,  2.8067022948695843e-15],
                                  [ 5.2272500000000000e-02, -2.1742514479148882e-06,
                                    2.7921989829582984e-11,  2.1560599506789471e-15],
                                  [ 4.2368799999999998e-02, -1.7333270533181388e-06,
                                    2.2135542537505570e-11,  1.6651736252244494e-15],
                                  [ 3.4463700000000000e-02, -1.3870836060512498e-06,
                                    1.7622230833105366e-11,  1.2900980754289186e-15],
                                  [ 2.8130100000000002e-02, -1.1141039420630264e-06,
                                    1.6249565311312671e-11,  5.6864462025850061e-16],
                                  [ 2.3036899999999999e-02, -9.0895994243051229e-07,
                                    1.5107976972204998e-11,  4.5520230277951044e-16],
                                  [ 1.8926700000000001e-02, -7.2373999999999925e-07,
                                    0.0000000000000000e+00,  0.0000000000000000e+00]])

# units='slug/ft**3'
USatm1976Data.akima_rho = np.array([[ 2.4475199999999999e-03, -7.1134999999999730e-08,
                                      0.0000000000000000e+00,  0.0000000000000000e+00],
                                    [ 2.4475199999999999e-03, -7.1134999999999730e-08,
                                      7.7487096774184926e-13,  1.0129032258008547e-17],
                                    [ 2.3771700000000001e-03, -6.9554870967741953e-08,
                                      7.6729893874119639e-13,  7.5720290007057986e-18],
                                    [ 2.3083900000000000e-03, -6.7997557003257482e-08,
                                      7.3768826394045220e-13,  9.8687393169674594e-18],
                                    [ 2.2411400000000000e-03, -6.6492574257425623e-08,
                                      7.2243665044487674e-13,  2.0137606980915046e-17],
                                    [ 2.1753900000000001e-03, -6.4987288135593137e-08,
                                      7.3478035281882466e-13,  2.5077827742370717e-18],
                                    [ 2.1111400000000001e-03, -6.3510204081632790e-08,
                                      6.9288203086124877e-13,  1.7322050771521626e-17],
                                    [ 2.0483400000000001e-03, -6.2072473867595688e-08,
                                      7.0494773519166813e-13,  7.5261324041506135e-18],
                                    [ 1.9869800000000002e-03, -6.0639999999999939e-08,
                                      6.8489208633077709e-13,  1.5107913669090256e-17],
                                    [ 1.9270400000000001e-03, -5.9224892086331154e-08,
                                      6.7742053629829010e-13,  7.4715500326987122e-18],
                                    [ 1.8684999999999999e-03, -5.7847636363636452e-08,
                                      6.5274484623200851e-13,  1.4891517404443190e-17],
                                    [ 1.8113199999999999e-03, -5.6497472118959092e-08,
                                      6.5739706810679723e-13,  1.0075050852316671e-17],
                                    [ 1.7554900000000000e-03, -5.5152452830188561e-08,
                                      6.4498199625527833e-13,  7.4708339334162299e-18],
                                    [ 1.7009900000000001e-03, -5.3840076335877735e-08,
                                      6.2250561293202883e-13,  1.7570722945726516e-17],
                                    [ 1.6477900000000001e-03, -5.2542352941176531e-08,
                                      6.2986336266797494e-13,  2.4895785084972468e-18],
                                    [ 1.5958800000000000e-03, -5.1275157480315103e-08,
                                      5.9515235900387206e-13,  2.0005121311106904e-17],
                                    [ 1.5452199999999999e-03, -5.0024837398374025e-08,
                                      6.1232785797263670e-13,  2.5095404014574724e-18],
                                    [ 1.4958100000000000e-03, -4.8792653061224426e-08,
                                      5.7777474169571258e-13,  1.4878319528724824e-17],
                                    [ 1.4476100000000000e-03, -4.7592468619246819e-08,
                                      5.8238404700438097e-13,  1.0084572242500619e-17],
                                    [ 1.4006100000000000e-03, -4.6397446808510589e-08,
                                      5.6997982391779639e-13,  7.4669845927697692e-18],
                                    [ 1.3547900000000000e-03, -4.5235086206896680e-08,
                                      5.5008391821779960e-13,  1.5002288678739151e-17],
                                    [ 1.3101199999999999e-03, -4.4089911504424830e-08,
                                      5.5491229456408418e-13,  4.9992098607924093e-18],
                                    [ 1.2665899999999999e-03, -4.2965089285714298e-08,
                                      5.3008682830907859e-13,  1.5002457405161147e-17],
                                    [ 1.2241699999999999e-03, -4.1859908256880631e-08,
                                      5.3490910635428269e-13,  4.9991505264785622e-18],
                                    [ 1.1828500000000000e-03, -4.0775092592592603e-08,
                                      5.1264964016116739e-13,  1.2442952431297358e-17],
                                    [ 1.1425999999999999e-03, -3.9712464454976377e-08,
                                      5.1236852347948686e-13,  1.0095931496967016e-17],
                                    [ 1.1034100000000000e-03, -3.8657439613526522e-08,
                                      5.0098490219973382e-13,  6.4547113267540748e-18],
                                    [ 1.0652599999999999e-03, -3.7636105675146792e-08,
                                      4.8238731811668812e-13,  1.3718357030143220e-17],
                                    [ 1.0281200000000000e-03, -3.6630175967822986e-08,
                                      4.8814023081138507e-13,  6.0357370116141593e-18],
                                    [ 9.9198400000000001e-04, -3.5635788295165360e-08,
                                      4.6807659033081704e-13,  1.0711704834587766e-17],
                                    [ 9.5682700000000005e-04, -3.4667499999999983e-08,
                                      4.6249999999996193e-13,  9.0000000000102058e-18],
                                    [ 9.2263100000000004e-04, -3.3715500000000028e-08,
                                      4.5324499729583359e-13,  9.2550027041879293e-18],
                                    [ 8.8937800000000002e-04, -3.2781244997295817e-08,
                                      4.4475445740161908e-13,  8.4905398942211421e-18],
                                    [ 8.5705000000000004e-04, -3.1866264462809922e-08,
                                      4.3450865534949613e-13,  9.7558074603978640e-18],
                                    [ 8.2562800000000002e-04, -3.0967979729729736e-08,
                                      4.2823453109277220e-13,  7.7451986369658092e-18],
                                    [ 7.9509600000000002e-04, -3.0088275071633295e-08,
                                      4.1678564414512136e-13,  9.4894274881025780e-18],
                                    [ 7.6543399999999995e-04, -2.9226235500878747e-08,
                                      7.1040460948845089e-13, -2.9116910860964500e-16],
                                    [ 7.3662700000000001e-04, -2.8678933607730787e-08,
                                      3.5945271055713260e-12, -2.8855934978405270e-15],
                                    [ 7.0865700000000002e-04, -3.0146659890109727e-08,
                                      -5.8605566062137374e-12,  3.3042164963234196e-15],
                                    [ 6.7595399999999999e-04, -3.1955123613566910e-08,
                                      -1.3870531241644998e-13,  3.7382892598340465e-16],
                                    [ 6.4423400000000004e-04, -3.1111047460449590e-08,
                                      1.0146188645610866e-12, -1.3557140411154530e-16],
                                    [ 6.1400199999999999e-04, -2.9488523943662046e-08,
                                      6.4259589323241502e-13,  3.2928050429590057e-17],
                                    [ 5.8518899999999996e-04, -2.8104548005908439e-08,
                                      6.1162004282461309e-13,  3.1927963083822717e-17],
                                    [ 5.5772799999999996e-04, -2.6785524031007742e-08,
                                      5.8333435725743045e-13,  3.0189673750326731e-17],
                                    [ 5.3155599999999998e-04, -2.5528286295241891e-08,
                                      5.5562037205392791e-13,  2.8665923188014141e-17],
                                    [ 5.0661200000000003e-04, -2.4331047781569979e-08,
                                      5.2961928740124997e-13,  2.7428494168671279e-17],
                                    [ 4.8283799999999997e-04, -2.3189523724261472e-08,
                                      5.0504744852292967e-13,  2.6476275738542161e-17],
                                    [ 4.6017999999999997e-04, -2.2099999999999983e-08,
                                      4.8183357951746670e-13,  2.4166420482521447e-17],
                                    [ 4.3858599999999998e-04, -2.1063833579517492e-08,
                                      4.5714334951112689e-13,  2.4690230006366227e-17],
                                    [ 4.1800399999999998e-04, -2.0075476190476146e-08,
                                      4.3850118789387886e-13,  2.1975002582312722e-17],
                                    [ 3.9838900000000002e-04, -1.9132548806941453e-08,
                                      4.1562153187819947e-13,  2.1927275063194640e-17],
                                    [ 3.7969399999999997e-04, -1.8235523917995451e-08,
                                      3.9707173085360346e-13,  2.0452187141885741e-17],
                                    [ 3.6187600000000002e-04, -1.7380023894862580e-08,
                                      3.7857159924892534e-13,  1.9452295613638517e-17],
                                    [ 3.4489399999999999e-04, -1.6564523809523830e-08,
                                      3.6080961773274848e-13,  1.8714191791085994e-17],
                                    [ 3.2870900000000000e-04, -1.5786761998685075e-08,
                                      3.4378624719758998e-13,  1.7975751487474501e-17],
                                    [ 3.1328399999999999e-04, -1.5045262249827472e-08,
                                      3.2757225652903237e-13,  1.6689993298447243e-17],
                                    [ 2.9858300000000000e-04, -1.4340047756874070e-08,
                                      3.1159551374820483e-13,  1.6452243125878653e-17],
                                    [ 2.8457100000000001e-04, -1.3667500000000025e-08,
                                      2.9826215139437550e-13,  1.5237848605612725e-17],
                                    [ 2.7121699999999998e-04, -1.3025262151394430e-08,
                                      2.8354855028055843e-13,  1.4713601113899771e-17],
                                    [ 2.5849000000000000e-04, -1.2414024247491621e-08,
                                      2.7007217919374898e-13,  1.3952068297865224e-17],
                                    [ 2.4635999999999999e-04, -1.1832023684210529e-08,
                                      2.5728515643951437e-13,  1.3738527771021078e-17],
                                    [ 2.3479900000000000e-04, -1.1276237788018437e-08,
                                      2.4628464064630115e-13,  1.1953147372127757e-17],
                                    [ 2.2378099999999999e-04, -1.0747809064609451e-08,
                                      2.3283234241688774e-13,  1.2976722192576590e-17],
                                    [ 2.1327900000000000e-04, -1.0243214213197949e-08,
                                      2.2447725866769641e-13,  1.0736954530266970e-17],
                                    [ 2.0327100000000001e-04, -9.7620488322717624e-09,
                                      2.1133565337032390e-13,  1.1713178901433272e-17],
                                    [ 1.9373200000000001e-04, -9.3042379888268164e-09,
                                      1.7732715258837530e-13,  3.5910836238444301e-17],
                                    [ 1.8464100000000001e-04, -8.8418511749347379e-09,
                                      1.5793934408908663e-13,  1.8911830845637883e-17],
                                    [ 1.7597600000000000e-04, -8.4692369942196527e-09,
                                      1.2666340348110555e-13, -4.4264092614431950e-18],
                                    [ 1.6762900000000000e-04, -8.2291894150417794e-09,
                                      1.3167294773060179e-13,  1.6516467311167995e-17],
                                    [ 1.5954800000000000e-04, -7.9162941176470636e-09,
                                      2.7058823529413479e-13, -3.5294117647070624e-17],
                                    [ 1.5186700000000000e-04, -7.4809999999999976e-09,
                                      1.7052631578945917e-13,  9.4736842105356658e-18],
                                    [ 1.4456600000000000e-04, -7.1115263157894748e-09,
                                      1.6157741292006255e-13,  8.9489028694106703e-18],
                                    [ 1.3762500000000000e-04, -6.7615247813411135e-09,
                                      1.5352340883605367e-13,  9.0013725050498677e-18],
                                    [ 1.3102599999999999e-04, -6.4274738461538549e-09,
                                      1.4673767615261243e-13,  7.7361700012439933e-18],
                                    [ 1.2475299999999999e-04, -6.1107899838449006e-09,
                                      1.3757996768982510e-13,  8.2100161550887398e-18],
                                    [ 1.1878800000000000e-04, -5.8109999999999867e-09,
                                      1.3176301615798117e-13,  7.2369838420101929e-18],
                                    [ 1.1311600000000001e-04, -5.5257630161579979e-09,
                                      1.2481501360495393e-13,  6.9480025530313822e-18],
                                    [ 1.0772200000000000e-04, -5.2552889812889901e-09,
                                      1.1860424169404258e-13,  6.6847395949472765e-18],
                                    [ 1.0259200000000000e-04, -4.9980262791160631e-09,
                                      1.1291294784251970e-13,  6.2133312735453337e-18],
                                    [ 9.7713099999999998e-05, -4.7535603896103877e-09,
                                      1.0698101300992592e-13,  5.9793766004636063e-18],
                                    [ 9.3072500000000000e-05, -4.5216602337891434e-09,
                                      1.0167557672832300e-13,  5.6846570608233857e-18],
                                    [ 8.8658200000000004e-05, -4.3012551091500265e-09,
                                      9.6691665378990866e-14,  5.3634437710288255e-18],
                                    [ 8.4458999999999999e-05, -4.0917814470789549e-09,
                                      9.1796853509604778e-14,  5.0845935693518845e-18],
                                    [ 8.0464100000000001e-05, -3.8929339593516897e-09,
                                      8.7173010794367378e-14,  4.8609485573161700e-18],
                                    [ 7.6663199999999995e-05, -3.7040050920910077e-09,
                                      8.2967791019636640e-14,  4.5373010713755315e-18],
                                    [ 7.3046700000000000e-05, -3.5244576068376070e-09,
                                      7.8767763165298098e-14,  4.3898436723054840e-18],
                                    [ 6.9605399999999996e-05, -3.3537525494900956e-09,
                                      7.4962764595362815e-14,  4.0897848947424119e-18],
                                    [ 6.6330700000000005e-05, -3.1915576656151431e-09,
                                      7.1094142256502644e-14,  3.9635233586304133e-18],
                                    [ 6.3214199999999995e-05, -3.0374788110262466e-09,
                                      6.7688952824409728e-14,  3.6898582018381935e-18],
                                    [ 6.0248099999999997e-05, -2.8910313307719126e-09,
                                      6.4265198308534702e-14,  3.5661324633808250e-18],
                                    [ 5.7424900000000000e-05, -2.7518025367647003e-09,
                                      6.1212608305301195e-14,  3.2899284594027800e-18],
                                    [ 5.4737600000000003e-05, -2.6195075347758916e-09,
                                      5.8038797675501675e-14,  3.2687371003852629e-18],
                                    [ 5.2179399999999997e-05, -2.4936237281237341e-09,
                                      5.5407541717547610e-14,  2.9161864061856282e-18],
                                    [ 4.9744099999999997e-05, -2.3740600854700800e-09,
                                      5.2420170940172082e-14,  2.9399145299129745e-18],
                                    [ 4.7425400000000002e-05, -2.2603999999999985e-09,
                                      5.0076289635582390e-14,  2.7237103644131270e-18],
                                    [ 4.5217799999999999e-05, -2.1520762896355931e-09,
                                      4.7562519629034981e-14,  2.5137700065573366e-18],
                                    [ 4.3115799999999998e-05, -2.0494099403578524e-09,
                                      4.5041148395119518e-14,  2.5687919627342707e-18],
                                    [ 4.1114000000000000e-05, -1.9516212676794097e-09,
                                      4.3200117776408577e-14,  2.2211499030022920e-18],
                                    [ 3.9207800000000001e-05, -1.8585575824175855e-09,
                                      4.0765164835161234e-14,  2.2924175824207568e-18],
                                    [ 3.7392299999999998e-05, -1.7701500000000003e-09,
                                      3.8978784194534607e-14,  2.0712158054690953e-18],
                                    [ 3.5663200000000001e-05, -1.6859787841945241e-09,
                                      5.5921655267874768e-14, -1.6942871073349883e-17],
                                    [ 3.4016200000000001e-05, -1.6249640868788252e-09,
                                      6.2270203097495159e-14, -6.2061162186747369e-18],
                                    [ 3.2447299999999997e-05, -1.5190420293398587e-09,
                                      4.1154121592667156e-14, -1.8699431449390517e-18],
                                    [ 2.5647200000000001e-05, -1.2477465492836160e-09,
                                      2.6054774735379300e-14,  2.6210702426879127e-19],
                                    [ 2.0092600000000001e-05, -9.6754077510966408e-10,
                                      1.9998262161729367e-14,  4.4757857204068466e-19],
                                    [ 1.5810800000000001e-05, -7.3398976058931897e-10,
                                      9.7217746606932535e-15,  8.8723549143409376e-19],
                                    [ 1.2494799999999999e-05, -5.7022935212482961e-10,
                                      7.5234885173161475e-15,  6.6687638152995596e-19],
                                    [ 9.9150999999999993e-06, -4.4497873833692160e-10,
                                      5.8469469734933930e-15,  5.0392013877819755e-19],
                                    [ 7.8993700000000006e-06, -3.4871525819362303e-10,
                                      4.5652846521719509e-15,  3.8219339731052419e-19],
                                    [ 6.3176999999999997e-06, -2.7439790687361426e-10,
                                      3.5754503311450798e-15,  2.9154620871555911e-19],
                                    [ 5.0715399999999999e-06, -2.1677743790849669e-10,
                                      3.2924292397259744e-15,  1.2717166839466897e-19],
                                    [ 4.0858599999999999e-06, -1.7431527038163657e-10,
                                      3.0547081526546450e-15,  1.0062918473453531e-19],
                                    [ 3.3032300000000000e-06, -1.3622100000000000e-10,
                                      0.0000000000000000e+00,  0.0000000000000000e+00]])

# units='lbf*s/ft**2'
USatm1976Data.akima_viscosity = np.array([[ 3.8099999999999998e-07, -3.4999999999999193e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.8099999999999998e-07, -3.4999999999999193e-12,
                                            5.4122168985403181e-29,  4.9999999999990461e-19],
                                          [ 3.7800000000000002e-07, -2.0000000000000973e-12,
                                            5.3314375418456864e-29,  0.0000000000000000e+00],
                                          [ 3.7599999999999998e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.7399999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.7200000000000000e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.7000000000000000e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.6800000000000001e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.6600000000000002e-07, -1.9999999999999915e-12,
                                            -1.5832753912147796e-28,  1.0582095726996742e-31],
                                          [ 3.6399999999999998e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.6199999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.5999999999999999e-07, -1.9999999999999915e-12,
                                            -3.0000000000000673e-15,  2.0000000000000448e-18],
                                          [ 3.5699999999999998e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.5499999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.5300000000000000e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.5100000000000001e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.4900000000000001e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.4700000000000002e-07, -1.9999999999999915e-12,
                                            -5.2506581851510548e-29,  0.0000000000000000e+00],
                                          [ 3.4499999999999998e-07, -2.0000000000000973e-12,
                                            -2.9999999999995900e-15,  1.9999999999997263e-18],
                                          [ 3.4200000000000002e-07, -2.0000000000000973e-12,
                                            5.3314375418456864e-29,  0.0000000000000000e+00],
                                          [ 3.3999999999999997e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.3799999999999998e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.3599999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.3400000000000000e-07, -1.9999999999999915e-12,
                                            -3.0000000000000673e-15,  2.0000000000000448e-18],
                                          [ 3.3099999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2899999999999999e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2700000000000000e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2500000000000001e-07, -1.9999999999999915e-12,
                                            -3.0000000000000673e-15,  2.0000000000000448e-18],
                                          [ 3.2200000000000000e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2000000000000001e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1800000000000002e-07, -1.9999999999999915e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1600000000000002e-07, -1.9999999999999915e-12,
                                            -3.0000000000000144e-15,  1.9999999999999917e-18],
                                          [ 3.1300000000000001e-07, -2.0000000000000444e-12,
                                            1.3247814497919584e-28, -7.9163769560738985e-32],
                                          [ 3.1100000000000002e-07, -2.0000000000000181e-12,
                                            8.0779356694631611e-31, -2.6657187709228433e-32],
                                          [ 3.0899999999999997e-07, -2.0000000000000973e-12,
                                            -2.9999999999996429e-15,  1.9999999999997802e-18],
                                          [ 3.0600000000000001e-07, -2.0000000000000444e-12,
                                            1.3247814497919584e-28, -7.9163769560738985e-32],
                                          [ 3.0400000000000002e-07, -2.0000000000000181e-12,
                                            -3.4331226595218436e-29,  8.8857292364094767e-33],
                                          [ 3.0199999999999998e-07, -2.0000000000000622e-12,
                                            -4.9999999999997578e-15,  3.9999999999998585e-18],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9900000000000002e-07,  0.0000000000000000e+00,
                                            2.9999999999999079e-15, -1.9999999999999385e-18],
                                          [ 2.9999999999999999e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9999999999999999e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 2.9999999999999999e-07,  0.0000000000000000e+00,
                                            3.0000000000000665e-15, -2.0000000000000444e-18],
                                          [ 3.0100000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0100000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0100000000000001e-07,  0.0000000000000000e+00,
                                            2.4999999999999101e-15, -1.4999999999999408e-18],
                                          [ 3.0199999999999998e-07,  4.9999999999999787e-13,
                                            -1.4999999999999936e-15,  9.9999999999999583e-19],
                                          [ 3.0199999999999998e-07,  4.9999999999999787e-13,
                                            2.0000000000000708e-15, -1.5000000000000465e-18],
                                          [ 3.0300000000000000e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0300000000000000e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0300000000000000e-07,  0.0000000000000000e+00,
                                            3.0000000000000665e-15, -2.0000000000000444e-18],
                                          [ 3.0400000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0400000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0400000000000002e-07,  0.0000000000000000e+00,
                                            2.9999999999999079e-15, -1.9999999999999385e-18],
                                          [ 3.0499999999999999e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0499999999999999e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0499999999999999e-07,  0.0000000000000000e+00,
                                            3.0000000000000665e-15, -2.0000000000000444e-18],
                                          [ 3.0600000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0600000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0600000000000001e-07,  0.0000000000000000e+00,
                                            2.4999999999999101e-15, -1.4999999999999408e-18],
                                          [ 3.0699999999999998e-07,  4.9999999999999787e-13,
                                            -1.4999999999999936e-15,  9.9999999999999583e-19],
                                          [ 3.0699999999999998e-07,  4.9999999999999787e-13,
                                            2.0000000000000708e-15, -1.5000000000000465e-18],
                                          [ 3.0800000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0800000000000001e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0800000000000001e-07,  0.0000000000000000e+00,
                                            2.9999999999999079e-15, -1.9999999999999385e-18],
                                          [ 3.0899999999999997e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0899999999999997e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.0899999999999997e-07,  0.0000000000000000e+00,
                                            3.0000000000000665e-15, -2.0000000000000444e-18],
                                          [ 3.1000000000000000e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1000000000000000e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1000000000000000e-07,  0.0000000000000000e+00,
                                            3.0000000000000665e-15, -2.0000000000000444e-18],
                                          [ 3.1100000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1100000000000002e-07,  0.0000000000000000e+00,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1100000000000002e-07,  0.0000000000000000e+00,
                                            3.9999999999998783e-17,  8.0000000000001768e-21],
                                          [ 3.1300000000000001e-07,  1.0000000000000010e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.1800000000000002e-07,  1.0000000000000010e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2300000000000002e-07,  1.0000000000000010e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.2800000000000003e-07,  1.0000000000000010e-12,
                                            -2.1002632740604221e-30,  0.0000000000000000e+00],
                                          [ 3.3299999999999998e-07,  9.9999999999997999e-13,
                                            -1.1999999999998787e-16,  1.5999999999998665e-20],
                                          [ 3.3700000000000001e-07,  1.0000000000000010e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.4200000000000002e-07,  1.0000000000000010e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00],
                                          [ 3.4700000000000002e-07,  1.0000000000000010e-12,
                                            -1.0000000000000220e-16,  1.2000000000000257e-20],
                                          [ 3.5100000000000001e-07,  8.9999999999999879e-13,
                                            2.0000000000000442e-17,  0.0000000000000000e+00],
                                          [ 3.5600000000000001e-07,  1.1000000000000032e-12,
                                            0.0000000000000000e+00,  0.0000000000000000e+00]])

# units='slug/ft**4'
USatm1976Data.akima_drho = np.array([[-7.1134999999999730e-08,  1.5915365661443047e-12,
                                      0.0000000000000000e+00,  0.0000000000000000e+00],
                                     [-7.1134999999999730e-08,  1.5915365661443047e-12,
                                      -1.5888214268472996e-17,  4.4806803818923110e-21],
                                     [-6.9554870967742006e-08,  1.5732021787530362e-12,
                                      1.9868064141285357e-17, -3.5756278409758959e-20],
                                     [-6.7997557003257443e-08,  1.5056694718063315e-12,
                                      -1.5705882702221777e-18,  8.8386229565740955e-22],
                                     [-6.6492574257425676e-08,  1.5051798821528600e-12,
                                      4.2822396892220829e-19, -3.2198428923067741e-22],
                                     [-6.4987288135593124e-08,  1.5050703772230129e-12,
                                      -2.2801329613776998e-17, -5.1849936488885183e-21],
                                     [-6.3510204081632777e-08,  1.4439127370487934e-12,
                                      -8.7180402361428864e-18,  2.5355172243987931e-21],
                                     [-6.2072473867595728e-08,  1.4340832082497040e-12,
                                      -1.1012012076208392e-18, -5.0813944625551214e-22],
                                     [-6.0639999999999900e-08,  1.4303563874956962e-12,
                                      -1.5711131745287506e-17,  4.6265791837674503e-22],
                                     [-5.9224892086331115e-08,  1.4003220977602512e-12,
                                      -2.2282986273166642e-17, -7.8338879244775467e-22],
                                     [-5.7847636363636478e-08,  1.3534059588365743e-12,
                                      -4.1500198065153752e-18,  9.0830564731397922e-22],
                                     [-5.6497472118959105e-08,  1.3478308361654861e-12,
                                      2.8598462763525304e-18, -5.6713936712806294e-21],
                                     [-5.5152452830188547e-08,  1.3365363477043488e-12,
                                      -4.0747875155160975e-17,  1.6588021761603760e-20],
                                     [-5.3840076335877755e-08,  1.3048046626788392e-12,
                                      2.5552918344300924e-20, -7.1068208959261661e-21],
                                     [-5.2542352941176498e-08,  1.2835353058277487e-12,
                                      -2.2093345749643974e-17,  5.7535007833033383e-21],
                                     [-5.1275157480315090e-08,  1.2566091166783715e-12,
                                      -6.3162618215787940e-18,  2.7227084259231984e-23],
                                     [-5.0024837398374038e-08,  1.2440582742879906e-12,
                                      1.1612409071035022e-18, -1.3035178045435220e-20],
                                     [-4.8792653061224379e-08,  1.2072752219658920e-12,
                                      -1.1626644462385376e-17,  4.5358644740466740e-21],
                                     [-4.7592468619246826e-08,  1.1976295264632612e-12,
                                      2.3294842832593455e-18, -4.9372000102502711e-21],
                                     [-4.6397446808510556e-08,  1.1874768949990297e-12,
                                      -3.9644525171465704e-17,  1.4528231786304982e-20],
                                     [-4.5235086206896687e-08,  1.1517725400150135e-12,
                                      -3.6978911852298484e-18, -2.8999463579604059e-21],
                                     [-4.4089911504424863e-08,  1.1356769185706726e-12,
                                      -1.1891911452886842e-17,  1.0372115927930661e-21],
                                     [-4.2965089285714285e-08,  1.1150047304432779e-12,
                                      -1.0084595058847438e-17,  2.6089344919681219e-22],
                                     [-4.1859908256880657e-08,  1.0956182206731736e-12,
                                      -5.4492777201575218e-18, -5.3532786649885392e-21],
                                     [-4.0775092592592630e-08,  1.0686598292378930e-12,
                                      -9.0443589567337028e-18,  3.0126673350943651e-21],
                                     [-3.9712464454976377e-08,  1.0596091133297081e-12,
                                      1.9652869940842878e-18, -6.5495588739176294e-21],
                                     [-3.8657439613526502e-08,  1.0438910106961237e-12,
                                      -3.3640592806505786e-17,  1.1083520490092157e-20],
                                     [-3.7636105675146792e-08,  1.0098603865533882e-12,
                                      -3.5774859219799466e-18, -3.5319330760228010e-22],
                                     [-3.6630175967822986e-08,  1.0016458347866211e-12,
                                      -3.6921650905509479e-18, -3.5659970384573975e-21],
                                     [-3.5635788295165373e-08,  9.8356351349014702e-13,
                                      -2.0854452471693423e-17,  5.5792341469571746e-21],
                                     [-3.4667499999999963e-08,  9.5859231098763129e-13,
                                      -5.0571390083506644e-18, -1.5351719793456751e-21],
                                     [-3.3715500000000028e-08,  9.4387251703289254e-13,
                                      -9.3042082551596938e-18, -3.1330607350206940e-22],
                                     [-3.2781244997295797e-08,  9.2432418230206735e-13,
                                      -1.0186263355845313e-17,  8.4261553965945695e-22],
                                     [-3.1866264462809916e-08,  9.0647950220935570e-13,
                                      -7.3615633328424121e-18, -8.3320579633418704e-22],
                                     [-3.0967979729729736e-08,  8.8925675815466852e-13,
                                      -1.8119498147068720e-17,  8.5673980888421548e-21],
                                     [-3.0088275071633295e-08,  8.7871995612705704e-13,
                                      -3.0625548138500810e-17,  1.3945162765994296e-20],
                                     [-2.9226235500878744e-08,  8.5930434814803800e-13,
                                      3.4354560442611082e-16, -6.5554805942618522e-19],
                                     [-2.8678933607730781e-08, -4.2024862127829613e-13,
                                      -1.9478561183834354e-15,  9.0037845728279828e-19],
                                     [-3.0146659890109713e-08, -1.6148254861967710e-12,
                                      -1.1948460966846793e-15,  1.0012078594242196e-18],
                                     [-3.1955123613566944e-08, -1.0008941012934693e-12,
                                      2.9757239015225854e-15, -1.1307536471117686e-18],
                                     [-3.1111047460449597e-08,  1.5582927604163948e-12,
                                      3.4863803905564854e-16, -2.8440728268449985e-19],
                                     [-2.9488523943662053e-08,  1.4023469904741932e-12,
                                      1.4847600928007699e-17, -3.3218653648594086e-20],
                                     [-2.8104548005908446e-08,  1.3323862313844263e-12,
                                      5.3931297008866332e-18, -1.8755386184611551e-20],
                                     [-2.6785524031007745e-08,  1.2869063322323639e-12,
                                      -2.7787368751301075e-17, -1.8812277152182286e-21],
                                     [-2.5528286295241901e-08,  1.2256879115841065e-12,
                                      -2.7052034049481441e-17, -1.3973638627167143e-21],
                                     [-2.4331047781569992e-08,  1.1673917518969931e-12,
                                      -2.5173332392942561e-17, -6.9436219552338336e-22],
                                     [-2.3189523724261465e-08,  1.1149620005245376e-12,
                                      -2.3077582146665960e-17, -2.3606941163923404e-21],
                                     [-2.2099999999999986e-08,  1.0617247538820286e-12,
                                      -2.5293906442169869e-17, -2.6442695735769620e-22],
                                     [-2.1063833579517485e-08,  1.0103436601256160e-12,
                                      -2.0795408536681276e-17, -1.1908625475887459e-21],
                                     [-2.0075476190476139e-08,  9.6518025540948704e-13,
                                      -2.0523756883488221e-17, -1.7291149913098051e-21],
                                     [-1.9132548806941450e-08,  9.1894539666858179e-13,
                                      -2.1651947273210852e-17, -2.6856044939173195e-22],
                                     [-1.8235523917995470e-08,  8.7483582077398560e-13,
                                      -1.7716179651799479e-17, -1.6196179893019383e-21],
                                     [-1.7380023894862586e-08,  8.3454460750248042e-13,
                                      -1.8295062568383675e-17, -7.4945959532384032e-22],
                                     [-1.6564523809523814e-08,  7.9570610357974155e-13,
                                      -1.7401657859014878e-17, -5.4263488198832926e-22],
                                     [-1.5786761998685075e-08,  7.5927488321574701e-13,
                                      -1.6461321344182155e-17, -1.3138130139611825e-21],
                                     [-1.5045262249827472e-08,  7.2241080148549875e-13,
                                      -1.6593713901761405e-17, -6.0259463033090528e-22],
                                     [-1.4340047756874065e-08,  6.8741558979098322e-13,
                                      -1.4183955554162996e-17, -6.8387736277959170e-22],
                                     [-1.3667500000000025e-08,  6.5699604659431866e-13,
                                      -1.3737237447385699e-17, -1.0209605413436249e-21],
                                     [-1.3025262151394435e-08,  6.2645869007551588e-13,
                                      -1.4600235418583654e-17, -6.2055075411120704e-22],
                                     [-1.2414024247491614e-08,  5.9539656697601516e-13,
                                      -1.3249225504204072e-17, -1.4677819072411664e-22],
                                     [-1.1832023684210527e-08,  5.6845778139543487e-13,
                                      -1.1014497462955215e-17, -1.6573877403891889e-21],
                                     [-1.1276237788018437e-08,  5.4145662324835667e-13,
                                      -1.3217239924372509e-17,  1.8934008500125431e-22],
                                     [-1.0747809064609451e-08,  5.1559016365461562e-13,
                                      -1.0156892290448547e-17, -8.3841995266196535e-22],
                                     [-1.0243214213197946e-08,  4.9276111921573283e-13,
                                      -3.6529716173230290e-18, -7.9427666722192850e-21],
                                     [-9.7620488322717558e-09,  4.6162687596442871e-13,
                                      -8.5767512067546221e-18,  4.7607186872668352e-21],
                                     [-9.3042379888268148e-09,  4.5875552961272018e-13,
                                      1.0257968968939357e-17, -6.6266846895775822e-21],
                                     [-8.8418511749347330e-09,  4.5939141348186594e-13,
                                      -1.0037264794850860e-16,  1.3595415181724534e-20],
                                     [-8.4692369942196510e-09,  2.9943236313002245e-13,
                                      -1.5664597626570558e-16,  9.7261192313562913e-20],
                                     [-8.2291894150417711e-09,  2.7792398753930019e-13,
                                      5.6418075812380397e-18,  2.9329502274161092e-20],
                                     [-7.9162941176470718e-09,  3.7719610952425958e-13,
                                      1.7298242857721933e-16, -1.1488442045441297e-19],
                                     [-7.4810000000000059e-09,  3.7850770531545934e-13,
                                      -2.3942113310479991e-18, -6.6398097738776100e-21],
                                     [-7.1115263157894723e-09,  3.5379985333173016e-13,
                                      8.3438860532041241e-19, -4.6327074886959986e-21],
                                     [-6.7615247813411177e-09,  3.4157050807628314e-13,
                                      -6.6049967518899370e-18, -9.1457613713197217e-22],
                                     [-6.4274738461538566e-09,  3.2561678616110710e-13,
                                      -8.6742265080057100e-18, -2.5869734414287161e-22],
                                     [-6.1107899838448981e-09,  3.0749224111266691e-13,
                                      -7.6382083942598821e-18, -6.4048873493114095e-23],
                                     [-5.8109999999999842e-09,  2.9202367770366780e-13,
                                      -5.8352151990445639e-18, -9.5147866263282079e-22],
                                     [-5.5257630161579938e-09,  2.7749881131768022e-13,
                                      -6.9726328207995482e-18, -5.2143627882827726e-23],
                                     [-5.2552889812889959e-09,  2.6339711479243264e-13,
                                      -5.7101677447448088e-18, -4.2424487475503965e-22],
                                     [-4.9980262791160631e-09,  2.5070404467867790e-13,
                                      -5.8567494356288441e-18, -3.8140573737364542e-22],
                                     [-4.7535603896103877e-09,  2.3784632859529927e-13,
                                      -5.7450801902909998e-18, -2.0109258376567230e-22],
                                     [-4.5216602337891451e-09,  2.2575289046342036e-13,
                                      -5.0151222812816921e-18, -3.3264354302079216e-22],
                                     [-4.3012551091500273e-09,  2.1472471527179450e-13,
                                      -4.9309234527853103e-18, -3.2012974794019189e-22],
                                     [-4.0917814470789582e-09,  2.0390247912240343e-13,
                                      -4.8421235635628972e-18, -2.1286783157203199e-22],
                                     [-3.8929339593516897e-09,  1.9357962850056156e-13,
                                      -4.3417587322866877e-18, -3.0900250759156861e-22],
                                     [-3.7040050920910065e-09,  1.8396910351321341e-13,
                                      -4.2067366831325878e-18, -2.1488157668211547e-22],
                                     [-3.5244576068376078e-09,  1.7491098541690181e-13,
                                      -3.9745070010575632e-18, -2.3142106833078366e-22],
                                     [-3.3537525494900943e-09,  1.6626770820979433e-13,
                                      -3.8667023159632166e-18, -2.0612201887943325e-22],
                                     [-3.1915576656151427e-09,  1.5791593752122950e-13,
                                      -3.6351957606466808e-18, -2.0188717168676245e-22],
                                     [-3.0374788110262466e-09,  1.5003988448487595e-13,
                                      -3.4025998943866983e-18, -1.8980433615519692e-22],
                                     [-2.8910313307719126e-09,  1.4266527168763696e-13,
                                      -3.2006660033832872e-18, -2.3581167704178807e-22],
                                     [-2.7518025367647007e-09,  1.3555650464974502e-13,
                                      -3.1689957720403573e-18, -9.2506888893509938e-23],
                                     [-2.6195075347758895e-09,  1.2894099243898373e-13,
                                      -2.8240248218540870e-18, -2.3316096497255142e-22],
                                     [-2.4936237281237325e-09,  1.2259345990035787e-13,
                                      -2.8587316146791882e-18, -1.7108563202827752e-22],
                                     [-2.3740600854700820e-09,  1.1636273977491477e-13,
                                      -2.6803005391073823e-18, -2.2353765722196804e-23],
                                     [-2.2603999999999969e-09,  1.1093507739953335e-13,
                                      -2.2670215147856730e-18, -3.4434552034519470e-22],
                                     [-2.1520762896355944e-09,  1.0536799780892647e-13,
                                      -2.7454419751963465e-18,  4.3793444013084560e-23],
                                     [-2.0494099403578512e-09,  1.0000849419057303e-13,
                                      -2.0222428011417791e-18, -1.9757871099064895e-22],
                                     [-1.9516212676794106e-09,  9.5371272455317539e-14,
                                      -2.1601851879217113e-18, -1.4740200557097873e-22],
                                     [-1.8585575824175857e-09,  9.0608696062761205e-14,
                                      -3.6930183885740694e-18,  1.4919047433977655e-21],
                                     [-1.7701500000000008e-09,  8.7698373515806451e-14,
                                      -5.0581399553473302e-18,  1.5309822450178060e-21],
                                     [-1.6859787841945239e-09,  8.2175040340165171e-14,
                                      -5.6219447669487436e-17,  3.5059104645021943e-20],
                                     [-1.6249640868788242e-09,  7.4913458936256121e-14,
                                      1.1170826792103251e-16, -8.0699669318323580e-20],
                                     [-1.5190420293398591e-09,  5.6230986823350418e-14,
                                      -1.0906436156226227e-18,  1.3925309064045260e-22],
                                     [-1.2477465492836160e-09,  5.5768532465158154e-14,
                                      3.2033376395433445e-19, -5.3161858005574747e-23],
                                     [-9.6754077510966367e-10,  5.4984730754283406e-14,
                                      -1.7805063830895783e-18,  2.5120162609336265e-23],
                                     [-7.3398976058931907e-10,  3.9063679119087850e-14,
                                      -1.4362877214131006e-18,  3.4793647235023175e-23],
                                     [-5.7022935212482941e-10,  2.7310325447583611e-14,
                                      -1.6550096653053374e-19, -5.7307914293973957e-23],
                                     [-4.4497873833692145e-10,  2.1357222210230224e-14,
                                      -2.8480570387978687e-19, -2.7219906486863257e-23],
                                     [-3.4871525819362287e-10,  1.6467672184917624e-14,
                                      -2.4665308188817878e-19, -1.4837460458999962e-23],
                                     [-2.7439790687361421e-10,  1.2888331831610841e-14,
                                      -6.5089423547665806e-20, -4.1551636833958929e-23],
                                     [-2.1677743790849654e-10,  9.1210648335872588e-15,
                                      -1.1581957375877374e-19, -1.9813383768574406e-24],
                                     [-1.7431527038163678e-10,  7.8142687177352104e-15,
                                      9.1920863413187333e-21, -9.6550029245778341e-24],
                                     [-1.3622099999999998e-10,  7.1820643618050634e-15,
                                      0.0000000000000000e+00,  0.0000000000000000e+00]])


class USatm1976Comp(om.ExplicitComponent):
    """
    Component model for the United States standard atmosphere 1976 tables.

    Data for the model was obtained from http://www.digitaldutch.com/atmoscalc/index.htm.

    Parameters
    ----------
    **kwargs : dict
        Dictionary of optional arguments.
    """
    def initialize(self):
        """
        Declare component options.
        """
        self.options.declare('num_nodes', types=int,
                             desc='Number of nodes to be evaluated in the RHS')

        gamma = 1.4  # Ratio of specific heads
        gas_c = 1716.49  # Gas constant (ft lbf)/(slug R)
        self._K = gamma * gas_c

    def setup(self):
        """
        Add component inputs and outputs.
        """
        nn = self.options['num_nodes']
        self.add_input('h', val=1.*np.ones(nn), units='ft')

        self.add_output('temp', val=1.*np.ones(nn), units='degR')
        self.add_output('pres', val=1.*np.ones(nn), units='psi')
        self.add_output('rho', val=1.*np.ones(nn), units='slug/ft**3')
        self.add_output('viscosity', val=1.*np.ones(nn), units='lbf*s/ft**2')
        self.add_output('drhos_dh', val=1.*np.ones(nn), units='slug/ft**4')
        self.add_output('sos', val=1*np.ones(nn), units='ft/s')

        arange = np.arange(nn)
        self.declare_partials(['temp', 'pres', 'rho', 'viscosity', 'drhos_dh', 'sos'], 'h',
                              rows=arange, cols=arange)

    def compute(self, inputs, outputs):
        """
        Interpolate atmospheric properties for a given altitude.

        Parameters
        ----------
        inputs : `Vector`
            `Vector` containing inputs.
        outputs : `Vector`
            `Vector` containing outputs.
        """
        table_points = USatm1976Data.alt
        h = inputs['h']

        idx = np.searchsorted(table_points, h, side='left')
        h_bin_left = np.hstack((table_points[0], table_points))
        dx = h - h_bin_left[idx]

        coeffs = USatm1976Data.akima_T[idx]
        outputs['temp'] = coeffs[:, 0] + dx * (coeffs[:, 1] + dx * (coeffs[:, 2] + dx * coeffs[:, 3]))

        coeffs = USatm1976Data.akima_P[idx]
        outputs['pres'] = coeffs[:, 0] + dx * (coeffs[:, 1] + dx * (coeffs[:, 2] + dx * coeffs[:, 3]))

        coeffs = USatm1976Data.akima_rho[idx]
        outputs['rho'] = coeffs[:, 0] + dx * (coeffs[:, 1] + dx * (coeffs[:, 2] + dx * coeffs[:, 3]))
        outputs['drhos_dh'] = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)

        coeffs = USatm1976Data.akima_viscosity[idx]
        outputs['viscosity'] = coeffs[:, 0] + dx * (coeffs[:, 1] + dx * (coeffs[:, 2] + dx * coeffs[:, 3]))

        outputs['sos'] = np.sqrt(self._K*outputs['temp'])

    def compute_partials(self, inputs, partials):
        """
        Compute sub-jacobian parts. The model is assumed to be in an unscaled state.

        Parameters
        ----------
        inputs : Vector
            Unscaled, dimensional input variables read via inputs[key].
        partials : Jacobian
            Subjac components written to partials[output_name, input_name].
        """
        table_points = USatm1976Data.alt
        h = inputs['h']

        idx = np.searchsorted(table_points, h, side='left')
        h_index = np.hstack((table_points[0], table_points))
        dx = h - h_index[idx]

        coeffs = USatm1976Data.akima_T[idx]
        dT_dh = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)
        T = coeffs[:, 0] + dx * (coeffs[:, 1] + dx * (coeffs[:, 2] + dx * coeffs[:, 3]))

        coeffs = USatm1976Data.akima_P[idx]
        dP_dh = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)

        coeffs = USatm1976Data.akima_rho[idx]
        drho_dh = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)

        coeffs = USatm1976Data.akima_viscosity[idx]
        dvisc_dh = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)

        coeffs = USatm1976Data.akima_drho[idx]
        d2rho_dh2 = coeffs[:, 1] + dx * (2.0 * coeffs[:, 2] + 3.0 * coeffs[:, 3] * dx)

        partials['temp', 'h'] = dT_dh.ravel()
        partials['pres', 'h'] = dP_dh.ravel()
        partials['rho', 'h'] = drho_dh.ravel()
        partials['viscosity', 'h'] = dvisc_dh.ravel()
        partials['drhos_dh', 'h'] = d2rho_dh2.ravel()
        partials['sos', 'h'][...] = 0.5/np.sqrt(self._K*T)*partials['temp', 'h'] * self._K


if __name__ == "__main__":

    # Running this script generates and prints the Akima coefficients using the OpenMDAO akima1D interpolant.

    from pprint import pprint

    from openmdao.components.interp_util.interp import InterpND
    import openmdao.api as om

    T_interp = InterpND(method='akima1D', points=USatm1976Data.alt, values=USatm1976Data.T, extrapolate=True)
    P_interp = InterpND(method='akima1D', points=USatm1976Data.alt, values=USatm1976Data.P, extrapolate=True)
    rho_interp = InterpND(method='akima1D', points=USatm1976Data.alt, values=USatm1976Data.rho, extrapolate=True)
    visc_interp = InterpND(method='akima1D', points=USatm1976Data.alt, values=USatm1976Data.viscosity, extrapolate=True)

    _, _drho_dh = rho_interp.interpolate(USatm1976Data.alt, compute_derivative=True)
    drho_interp = InterpND(method='akima1D', points=USatm1976Data.alt, values=_drho_dh.ravel(), extrapolate=True)

    # Find midpoints of all bins plus an extrapolation point on each end.
    h = np.hstack((-2000, USatm1976Data.alt, 155000))
    hbin = h[:-1] + 0.5 * np.diff(h)
    n = len(hbin)

    coeffs_T = np.empty((n, 4))
    coeffs_P = np.empty((n, 4))
    coeffs_rho = np.empty((n, 4))
    coeffs_visc = np.empty((n, 4))
    coeffs_drho = np.empty((n, 4))

    interps = [T_interp, P_interp, rho_interp, visc_interp, drho_interp]
    coeff_arrays = [coeffs_T, coeffs_P, coeffs_rho, coeffs_visc, coeffs_drho]

    np.set_printoptions(precision=18)
    for interp, coeff_array in zip(interps, coeff_arrays):
        _ = interp.interpolate(hbin, compute_derivative=False)
        coeff_cache = interp.table.coeffs

        for i in range(n):
            a, b, c, d = coeff_cache[i - 1]
            coeff_array[i, 0] = a
            coeff_array[i, 1] = b
            coeff_array[i, 2] = c
            coeff_array[i, 3] = d

        print('coeffs')
        pprint(coeff_array)

    print('done')
